<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Debug - APAFA Web</title>
    <link rel="stylesheet" href="assets/lib/bootstrap/dist/css/bootstrap.min.css" />
</head>
<body>
    <div class="container mt-5">
        <h1>üêõ DEBUG - APAFA Web</h1>
        <div id="debug-output" class="mt-4"></div>
        <div id="main-content" class="mt-4">
            <div class="card">
                <div class="card-body">
                    <h5>Contenido de la p√°gina</h5>
                    <p id="socios-apafa-count">Cargando...</p>
                    <p id="total-recaudado">Cargando...</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const debugOutput = document.getElementById('debug-output');

        function debug(msg, type = 'info') {
            const div = document.createElement('div');
            div.className = `alert alert-${type === 'error' ? 'danger' : type === 'success' ? 'success' : 'info'}`;
            div.innerHTML = `<small><strong>${new Date().toLocaleTimeString()}:</strong> ${msg}</small>`;
            debugOutput.appendChild(div);
            console.log(`${type}: ${msg}`);
        }

        // Test b√°sico de fetch
        debug('Iniciando debug b√°sico...');

        // Verificar que podemos hacer fetch
        fetch('data/stats.json')
            .then(response => {
                debug(`Fetch response status: ${response.status}`, response.ok ? 'success' : 'error');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}`);
                }
                return response.json();
            })
            .then(data => {
                debug(`Datos cargados: ${JSON.stringify(data)}`, 'success');
                document.getElementById('socios-apafa-count').textContent = `Socios APAFA: ${data.socios_apafa}`;
                document.getElementById('total-recaudado').textContent = `Total padres: ${data.total_padres}`;
            })
            .catch(error => {
                debug(`Error en fetch b√°sico: ${error.message}`, 'error');
            });

        // Verificar data-loader
        setTimeout(() => {
            debug('Verificando data-loader...');
            if (typeof ApafaData !== 'undefined') {
                debug('‚úÖ ApafaData est√° disponible', 'success');

                ApafaData.loadData('stats')
                    .then(data => {
                        debug(`Data-loader funcion√≥: ${JSON.stringify(data)}`, 'success');
                    })
                    .catch(error => {
                        debug(`Data-loader fall√≥: ${error.message}`, 'error');
                    });
            } else {
                debug('‚ùå ApafaData no est√° disponible', 'error');
            }
        }, 1000);

        debug('Debug b√°sico configurado. Esperando resultados...');
    </script>

    <!-- Data loader -->
    <script src="assets/js/data-loader.js"></script>
</body>
</html>